The softmax should be replaced with sigmoid as otherwise the whole thing blows up and diverges
